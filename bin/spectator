#!/usr/bin/env ruby
# coding: utf-8

usage = "Usage: spectator [yaml-config] [ruby-script-file]"
case ARGV.first
when '-h'
  puts usage
when '--help', 'help'
  puts usage
  puts
  puts "To control spectator hit CTRL-C while it's running."
  puts "You'll get this prompt:"
  puts "--- What to do now? (q=quit, a=all-specs): "
  puts
  puts 'Hit CTRL-C again or type "q" and then ENTER to quit.'
  puts 'Type "a" and then ENTER to run the full spec suite.'
  exit
end

require 'spectator'

require 'yaml'
config_file = ARGV.first || '.spectator'
YAML.load_file(config_file).each do |name, value|
  ENV[name] ||= value
end if File.exist? config_file

script_file = ARGV[1] || '.spectator.rb'
load script_file if File.exist? script_file

config = Spectator.config(debug: ARGV.include?('--debug'))
Spectator.run(config)
